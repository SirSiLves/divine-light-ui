<p-dialog [(visible)]="displayModal" [modal]="true"
          [style]="{width: '50vw', 'max-width': '30rem',  'min-width': '20rem'}"
          [baseZIndex]="10000"
          [draggable]="true"
          (onHide)="escape()"
          [resizable]="false">
  <ng-template pTemplate="header">
    <ng-container [ngSwitch]="step">
      <h3>
        <ng-container *ngSwitchCase="'start'">
          {{'features.poll.start.title' | translate}}
        </ng-container>

        <ng-container *ngSwitchCase="'minimax'">
          {{'features.poll.minimax.title' | translate}}
        </ng-container>

        <ng-container *ngSwitchCase="'dqn'">
          {{'features.poll.dqn.title' | translate}}
        </ng-container>

        <ng-container *ngSwitchCase="'questions'">
          {{'features.poll.questions.title' | translate}}
        </ng-container>

        <ng-container *ngSwitchCase="'end'">
          {{'features.poll.end.title' | translate}}
        </ng-container>

        <ng-container *ngSwitchDefault>
          // HEADER {{step}}
        </ng-container>
      </h3>
    </ng-container>
  </ng-template>

  <!-- CONTENT -->
  <ng-container [ngSwitch]="step">
    <ng-container *ngSwitchCase="'start'">
      {{'features.poll.start.description' | translate}} <br>
      {{'features.poll.start.howto' | translate}}
      <a href="/how-to-play">{{'features.poll.start.howtolink' | translate}}</a>. <br>
    </ng-container>

    <ng-container *ngSwitchCase="'minimax'">
      {{'features.poll.minimax.description' | translate}}
    </ng-container>

    <ng-container *ngSwitchCase="'dqn'">
      {{'features.poll.dqn.description' | translate}}
    </ng-container>

    <ng-container *ngSwitchCase="'questions'">
      {{'features.poll.questions.description' | translate}}<br><br>

      <form [formGroup]="formGroup">
        <div class="grid">

          <div class="col-12 mt-2 question">
            {{'features.poll.questions.01.question' | translate}}
          </div>
          <div class="col-12">
            <div class="grid">
              <div class="col-3">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'1-20'" [formControlName]="'question01'" inputId="q01-1"></p-radioButton>
                  <label for="q01-1" class="ml-2">1-20</label>
                </div>
              </div>
              <div class="col-3">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'21-34'" [formControlName]="'question01'" inputId="q01-2"></p-radioButton>
                  <label for="q01-2" class="ml-2">21-34</label>
                </div>
              </div>
              <div class="col-3">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'35-50'" [formControlName]="'question01'" inputId="q01-3"></p-radioButton>
                  <label for="q01-3" class="ml-2">35-50</label>
                </div>
              </div>
              <div class="col-3">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'51-99'" [formControlName]="'question01'" inputId="q01-4"></p-radioButton>
                  <label for="q01-4" class="ml-2">51-99</label>
                </div>
              </div>
            </div>
          </div>

          <div class="col-12 mt-2 question">
            {{'features.poll.questions.02.question' | translate}}
          </div>
          <div class="col-12">
            <div class="grid">
              <div class="col-3">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'YES'" [formControlName]="'question02'" inputId="q02-1"></p-radioButton>
                  <label for="q02-1" class="ml-2">{{'features.poll.questions.02.yes' | translate}}</label>
                </div>
              </div>
              <div class="col-3">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'NO'" [formControlName]="'question02'" inputId="q02-2"></p-radioButton>
                  <label for="q02-2" class="ml-2">{{'features.poll.questions.02.no' | translate}}</label>
                </div>
              </div>
            </div>
          </div>

          <div class="col-12 mt-2 question">
            {{'features.poll.questions.03.question' | translate}}
          </div>
          <div class="col-12">
            <div class="grid">
              <div class="col-3">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'YES'" [formControlName]="'question03'" inputId="q03-1"></p-radioButton>
                  <label for="q03-1" class="ml-2">{{'features.poll.questions.03.yes' | translate}}</label>
                </div>
              </div>
              <div class="col-3">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'NO'" [formControlName]="'question03'" inputId="q03-2"></p-radioButton>
                  <label for="q03-2" class="ml-2">{{'features.poll.questions.03.no' | translate}}</label>
                </div>
              </div>
            </div>
          </div>

          <div class="col-12 mt-2 question">
            {{'features.poll.questions.04.question' | translate}}
          </div>
          <div class="col-12">
            <div class="grid">
              <div class="col-2">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'1'" [formControlName]="'question04'" inputId="q04-1"></p-radioButton>
                  <label for="q04-1" class="ml-2">1</label>
                </div>
              </div>
              <div class="col-2">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'2'" [formControlName]="'question04'" inputId="q04-2"></p-radioButton>
                  <label for="q04-2" class="ml-2">2</label>
                </div>
              </div>
              <div class="col-2">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'3'" [formControlName]="'question04'" inputId="q04-3"></p-radioButton>
                  <label for="q04-3" class="ml-2">3</label>
                </div>
              </div>
              <div class="col-2">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'4'" [formControlName]="'question04'" inputId="q04-4"></p-radioButton>
                  <label for="q04-4" class="ml-2">4</label>
                </div>
              </div>
              <div class="col-2">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'5'" [formControlName]="'question04'" inputId="q04-5"></p-radioButton>
                  <label for="q04-5" class="ml-2">5</label>
                </div>
              </div>
              <div class="col-2">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'6'" [formControlName]="'question04'" inputId="q04-6"></p-radioButton>
                  <label for="q04-6" class="ml-2">6</label>
                </div>
              </div>
            </div>
          </div>

          <div class="col-12 mt-2 question">
            {{'features.poll.questions.05.question' | translate}}
          </div>
          <div class="col-12">
            <div class="grid">
              <div class="col-2">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'1'" [formControlName]="'question05'" inputId="q05-1"></p-radioButton>
                  <label for="q05-1" class="ml-2">1</label>
                </div>
              </div>
              <div class="col-2">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'2'" [formControlName]="'question05'" inputId="q05-2"></p-radioButton>
                  <label for="q05-2" class="ml-2">2</label>
                </div>
              </div>
              <div class="col-2">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'3'" [formControlName]="'question05'" inputId="q05-3"></p-radioButton>
                  <label for="q05-3" class="ml-2">3</label>
                </div>
              </div>
              <div class="col-2">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'4'" [formControlName]="'question05'" inputId="q05-4"></p-radioButton>
                  <label for="q05-4" class="ml-2">4</label>
                </div>
              </div>
              <div class="col-2">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'5'" [formControlName]="'question05'" inputId="q05-5"></p-radioButton>
                  <label for="q05-5" class="ml-2">5</label>
                </div>
              </div>
              <div class="col-2">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'6'" [formControlName]="'question05'" inputId="q05-6"></p-radioButton>
                  <label for="q05-6" class="ml-2">6</label>
                </div>
              </div>
            </div>
          </div>

          <div class="col-12 mt-2 question">
            {{'features.poll.questions.06.question' | translate}}
          </div>
          <div class="col-12">
            <div class="grid">
              <div class="col-6">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'MINIMAX'" [formControlName]="'question06'" inputId="minimax06"></p-radioButton>
                  <label for="minimax06" class="ml-2">{{'features.poll.questions.06.minimax' | translate}}</label>
                </div>
              </div>
              <div class="col-6">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'DQN'" [formControlName]="'question06'" inputId="dqn06"></p-radioButton>
                  <label for="dqn06" class="ml-2">{{'features.poll.questions.06.dqn' | translate}}</label>
                </div>
              </div>
            </div>
          </div>

          <div class="col-12 mt-2 question">
            {{'features.poll.questions.07.question' | translate}}
          </div>
          <div class="col-12">
            <div class="grid">
              <div class="col-6">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'MINIMAX'" [formControlName]="'question07'" inputId="minimax07"></p-radioButton>
                  <label for="minimax07" class="ml-2">{{'features.poll.questions.07.minimax' | translate}}</label>
                </div>
              </div>
              <div class="col-6">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'DQN'" [formControlName]="'question07'" inputId="dqn07"></p-radioButton>
                  <label for="dqn07" class="ml-2">{{'features.poll.questions.07.dqn' | translate}}</label>
                </div>
              </div>
            </div>
          </div>

          <div class="col-12 mt-2 question">
            {{'features.poll.questions.08.question' | translate}}
          </div>
          <div class="col-12">
            <div class="grid">
              <div class="col-6">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'MINIMAX'" [formControlName]="'question08'" inputId="minimax08"></p-radioButton>
                  <label for="minimax08" class="ml-2">{{'features.poll.questions.08.minimax' | translate}}</label>
                </div>
              </div>
              <div class="col-6">
                <div class="p-field-radiobutton">
                  <p-radioButton [value]="'DQN'" [formControlName]="'question08'" inputId="dqn08"></p-radioButton>
                  <label for="dqn08" class="ml-2">{{'features.poll.questions.08.dqn' | translate}}</label>
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>
    </ng-container>

    <ng-container *ngSwitchCase="'end'">
      {{'features.poll.end.description' | translate}}
    </ng-container>

    <ng-container *ngSwitchDefault>
      // CONTENT {{step}}
    </ng-container>
  </ng-container>

  <ng-template pTemplate="footer">

    <div class="footer">
      <ng-container [ngSwitch]="step">
        <ng-container *ngSwitchCase="'start'">
          <div></div>
          <button pButton type="button"
                  [label]="'features.poll.next' | translate"
                  class="p-button-primary"
                  [disabled]="isSaving"
                  (click)="next()"></button>
        </ng-container>

        <ng-container *ngSwitchCase="'minimax'">
          <button pButton type="button"
                  [pTooltip]="'features.poll.back' | translate"
                  class="p-button-warning p-button-text"
                  [icon]="'pi pi-angle-left'"
                  [disabled]="step === 'start' || isSaving"
                  (click)="back()"></button>
          <button pButton type="button"
                  [label]="'features.poll.play' | translate"
                  class="p-button-primary"
                  [disabled]="isSaving"
                  (click)="play('minimax')"></button>
          <button pButton type="button"
                  [pTooltip]="'features.poll.next' | translate"
                  class="p-button-text"
                  [icon]="'pi pi-angle-right'"
                  [disabled]="isSaving"
                  (click)="next()"></button>
        </ng-container>

        <ng-container *ngSwitchCase="'dqn'">
          <button pButton type="button"
                  [pTooltip]="'features.poll.back' | translate"
                  class="p-button-warning p-button-text"
                  [icon]="'pi pi-angle-left'"
                  [disabled]="step === 'start' || isSaving"
                  (click)="back()"></button>
          <button pButton type="button"
                  [label]="'features.poll.play' | translate"
                  class="p-button-primary"
                  [disabled]="isSaving"
                  (click)="play('dqn')"></button>
          <button pButton type="button"
                  [pTooltip]="'features.poll.next' | translate"
                  class="p-button-text"
                  [icon]="'pi pi-angle-right'"
                  [disabled]="isSaving"
                  (click)="next()"></button>
        </ng-container>

        <ng-container *ngSwitchCase="'questions'">
          <button pButton type="button"
                  [pTooltip]="'features.poll.back' | translate"
                  class="p-button-warning p-button-text"
                  [icon]="'pi pi-angle-left'"
                  [disabled]="step === 'start' || isSaving"
                  (click)="back()"></button>
          <button pButton type="button"
                  [label]="'features.poll.send' | translate"
                  class="p-button-primary"
                  [disabled]="formGroup.invalid || isSaving"
                  (click)="send()"></button>
          <button pButton type="button"
                  [pTooltip]="'features.poll.next' | translate"
                  class="p-button-text"
                  [icon]="'pi pi-angle-right'"
                  [disabled]="isSaving"
                  (click)="next()"></button>
        </ng-container>

        <ng-container *ngSwitchDefault>
          <button pButton type="button"
                  [pTooltip]="'features.poll.back' | translate"
                  class="p-button-warning p-button-text"
                  [icon]="'pi pi-angle-left'"
                  [disabled]="step === 'start' || isSaving"
                  (click)="back()"></button>
          <ng-container *ngIf="step !== 'end'; else end">
            <button pButton type="button"
                    [pTooltip]="'features.poll.next' | translate"
                    class="p-button-text"
                    [disabled]="isSaving"
                    [icon]="'pi pi-angle-right'"
                    (click)="next()"></button>
          </ng-container>
          <ng-template #end>
            <button pButton type="button"
                    [label]="'features.poll.close' | translate"
                    class="p-button-primary"
                    [disabled]="isSaving"
                    (click)="close()"></button>
          </ng-template>
        </ng-container>
      </ng-container>
    </div>
  </ng-template>
</p-dialog>
